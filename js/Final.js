//*************GOKU CODES****************

// GOKU MOVES
var gokuSteadyState = ['js/personas/Goku/Regular/Goku_0-0.png', 'js/personas/Goku/Regular/Goku_0-1.png', 'js/personas/Goku/Regular/Goku_0-2.png', 
'js/personas/Goku/Regular/Goku_0-3.png', 'js/personas/Goku/Regular/Goku_0-2.png', 'js/personas/Goku/Regular/Goku_0-1.png']

var gokuPunch = ['js/personas/Goku/Regular/Goku_0-48.png', 'js/personas/Goku/Regular/Goku_0-49.png',
'js/personas/Goku/Regular/Goku_0-50.png', 'js/personas/Goku/Regular/Goku_0-51.png',
'js/personas/Goku/Regular/Goku_0-114.png', 'js/personas/Goku/Regular/Goku_0-115.png',
'js/personas/Goku/Regular/Goku_0-116.png','js/personas/Goku/Regular/Goku_0-117.png',
'js/personas/Goku/Regular/Goku_0-136.png', 'js/personas/Goku/Regular/Goku_0-137.png',
'js/personas/Goku/Regular/Goku_0-138.png', 'js/personas/Goku/Regular/Goku_0-139.png',
'js/personas/Goku/Regular/Goku_0-140.png', 'js/personas/Goku/Regular/Goku_0-141.png']

var gokuKick = ['js/personas/Goku/Regular/Goku_0-52.png', 'js/personas/Goku/Regular/Goku_0-53.png',
'js/personas/Goku/Regular/Goku_0-54.png', 'js/personas/Goku/Regular/Goku_0-55.png', 
'js/personas/Goku/Regular/Goku_0-56.png', 'js/personas/Goku/Regular/Goku_0-57.png',
'js/personas/Goku/Regular/Goku_0-68.png', 'js/personas/Goku/Regular/Goku_0-69.png',
'js/personas/Goku/Regular/Goku_0-70.png', 'js/personas/Goku/Regular/Goku_0-71.png',
'js/personas/Goku/Regular/Goku_0-72.png', 'js/personas/Goku/Regular/Goku_0-73.png',
'js/personas/Goku/Regular/Goku_0-74.png', 'js/personas/Goku/Regular/Goku_0-75.png',
'js/personas/Goku/Regular/Goku_0-76.png']

var gokuKiBlast = ['js/personas/Goku/Regular/Goku_0-58.png', 'js/personas/Goku/Regular/Goku_0-59.png',
'js/personas/Goku/Regular/Goku_0-60.png', 'js/personas/Goku/Regular/Goku_0-61.png',
'js/personas/Goku/Regular/Goku_0-62.png']

var gokuSS = ['js/personas/Goku/Regular/Goku_0-209.png', 'js/personas/Goku/Regular/Goku_0-210.png',
'js/personas/Goku/Regular/Goku_0-211.png', 'js/personas/Goku/Regular/Goku_0-212.png',
'js/personas/Goku/Regular/Goku_0-213.png', 'js/personas/Goku/Regular/Goku_0-214.png',
'js/personas/Goku/Regular/Goku_0-215.png', 'js/personas/Goku/Regular/Goku_0-215.png']

var gokuSSCharging = ['js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-1.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-2.png',
'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-3.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-4.png',
'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-5.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-6.png']

var gokuBeingHit = ['js/personas/Goku/Regular/Goku_0-222.png', 'js/personas/Goku/Regular/Goku_0-223.png',
'js/personas/Goku/Regular/Goku_0-224.png', 'js/personas/Goku/Regular/Goku_0-225.png',
'js/personas/Goku/Regular/Goku_0-226.png', 'js/personas/Goku/Regular/Goku_0-227.png',
'js/personas/Goku/Regular/Goku_0-228.png', 'js/personas/Goku/Regular/Goku_0-229.png',
'js/personas/Goku/Regular/Goku_0-230.png', 'js/personas/Goku/Regular/Goku_0-231.png',
'js/personas/Goku/Regular/Goku_0-232.png']

var gokuHitEffectsList = ['js/Hit/Effects/Effects_2.png', 'js/Hit/Effects/Effects_3.png']

var gokuDeadStateSequence = ['js/personas/Goku/Regular/Goku_0-256.png', 'js/personas/Goku/Regular/Goku_0-257.png',
'js/personas/Goku/Regular/Goku_0-258.png', 'js/personas/Goku/Regular/Goku_0-259.png',
'js/personas/Goku/Regular/Goku_0-260.png']

var gokuPowerUpSequence = ['js/personas/Goku/Regular/Goku_0-156.png', 'js/personas/Goku/Regular/Goku_0-157.png',
'js/personas/Goku/Regular/Goku_0-158.png', 'js/personas/Goku/Regular/Goku_0-159.png',
'js/personas/Goku/Regular/Goku_0-160.png', 'js/personas/Goku/Regular/Goku_0-161.png',]


//****************VEGETA CODES******************

//VEGETA MOVES
var vegetaSteadyState = ['js/personas/Vegeta/Regular/Vegeta_0-0.png', 'js/personas/Vegeta/Regular/Vegeta_0-1.png', 'js/personas/Vegeta/Regular/Vegeta_0-2.png', 
'js/personas/Vegeta/Regular/Vegeta_0-3.png', 'js/personas/Vegeta/Regular/Vegeta_0-2.png', 'js/personas/Vegeta/Regular/Vegeta_0-1.png']

var vegetaPunch = ['js/personas/Vegeta/Regular/Vegeta_0-50.png', 'js/personas/Vegeta/Regular/Vegeta_0-51.png',
'js/personas/Vegeta/Regular/Vegeta_0-52.png', 'js/personas/Vegeta/Regular/Vegeta_0-53.png',
'js/personas/Vegeta/Regular/Vegeta_0-54.png', 'js/personas/Vegeta/Regular/Vegeta_0-55.png',
'js/personas/Vegeta/Regular/Vegeta_0-56.png', 'js/personas/Vegeta/Regular/Vegeta_0-57.png',
'js/personas/Vegeta/Regular/Vegeta_0-58.png', 'js/personas/Vegeta/Regular/Vegeta_0-81.png',
'js/personas/Vegeta/Regular/Vegeta_0-82.png', 'js/personas/Vegeta/Regular/Vegeta_0-83.png',
'js/personas/Vegeta/Regular/Vegeta_0-84.png', 'js/personas/Vegeta/Regular/Vegeta_0-5.png']

var vegetaKick = ['js/personas/Vegeta/Regular/Vegeta_0-110.png', 'js/personas/Vegeta/Regular/Vegeta_0-111.png',
'js/personas/Vegeta/Regular/Vegeta_0-112.png', 'js/personas/Vegeta/Regular/Vegeta_0-113.png', 
'js/personas/Vegeta/Regular/Vegeta_0-114.png', 'js/personas/Vegeta/Regular/Vegeta_0-115.png',
'js/personas/Vegeta/Regular/Vegeta_0-116.png', 'js/personas/Vegeta/Regular/Vegeta_0-117.png',
'js/personas/Vegeta/Regular/Vegeta_0-132.png', 'js/personas/Vegeta/Regular/Vegeta_0-133.png',
'js/personas/Vegeta/Regular/Vegeta_0-134.png', 'js/personas/Vegeta/Regular/Vegeta_0-135.png',
'js/personas/Vegeta/Regular/Vegeta_0-136.png', 'js/personas/Vegeta/Regular/Vegeta_0-137.png',
'js/personas/Vegeta/Regular/Vegeta_0-138.png']

var vegetaKiBlast = ['js/personas/Vegeta/Regular/Vegeta_0-199.png', 'js/personas/Vegeta/Regular/Vegeta_0-200.png',
'js/personas/Vegeta/Regular/Vegeta_0-201.png', 'js/personas/Vegeta/Regular/Vegeta_0-202.png',
'js/personas/Vegeta/Regular/Vegeta_0-203.png']

var vegetaSS = ['js/personas/Vegeta/Regular/Vegeta_0-168.png', 'js/personas/Vegeta/Regular/Vegeta_0-169.png', 'js/personas/Vegeta/Regular/Vegeta_0-170.png',
'js/personas/Vegeta/Regular/Vegeta_0-171.png', 'js/personas/Vegeta/Regular/Vegeta_0-172.png',
'js/personas/Vegeta/Regular/Vegeta_0-173.png', 'js/personas/Vegeta/Regular/Vegeta_0-174.png']

var vegetaSSBlast = ['js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_0-1.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_0-2.png',
'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_0-3.png']

var vegetaSSCharging = ['js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-1.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-2.png',
'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-3.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-4.png',
'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-5.png', 'js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_2-6.png']

var vegetaHit = ['js/personas/Vegeta/Regular/Vegeta_0-218.png', 'js/personas/Vegeta/Regular/Vegeta_0-219.png',
'js/personas/Vegeta/Regular/Vegeta_0-220.png', 'js/personas/Vegeta/Regular/Vegeta_0-221.png',
'js/personas/Vegeta/Regular/Vegeta_0-222.png', 'js/personas/Vegeta/Regular/Vegeta_0-223.png',
'js/personas/Vegeta/Regular/Vegeta_0-224.png', 'js/personas/Vegeta/Regular/Vegeta_0-225.png',
'js/personas/Vegeta/Regular/Vegeta_0-226.png', 'js/personas/Vegeta/Regular/Vegeta_0-227.png',
'js/personas/Vegeta/Regular/Vegeta_0-228.png']

var vegetaHitEffectsList = ['js/Hit/Effects/Effects_2.png', 'js/Hit/Effects/Effects_3.png']

var vegetaDeadStateSequence = ['js/personas/Vegeta/Regular/Vegeta_0-247.png', 'js/personas/Vegeta/Regular/Vegeta_0-248.png',
'js/personas/Vegeta/Regular/Vegeta_0-249.png', 'js/personas/Vegeta/Regular/Vegeta_0-250.png',
'js/personas/Vegeta/Regular/Vegeta_0-251.png']

//************************START GAME****************************
var bgMusic = new Audio('js/Background Music/bgMusic_02.mp3')
var startGame = false

//*******************BACKGROUND IMAGE****************************

var stage = new Raster(new Size(1500, 1000))
stage.position = view.center
stage.source = 'js/Stage/Stage2.jpg'

var start = new PointText(new Point(750, 500))
start.justification = 'center'
start.content = 'Press Space to Start Game'
start.fillColor = 'white'
start.fontWeight = 'bold'
start. fontSize = 100
start.fontFamily = 'serif'
start.shadowColor = new Color(0, 0, 0)
start.shadowBlur = 20
start.shadowOffset = new Point(7, 7)


//***********************GOKU'S HP*******************************
var gokuHpBorderPoint = new Point(100, 50);
var gokuHpBorderSize = new Size(400, 30);
var gokuHpBorder = new Shape.Rectangle(gokuHpBorderPoint, gokuHpBorderSize);
gokuHpBorder.strokeColor = 'red';
gokuHpBorder.strokeWidth = 10;

var gokuHpPoint = new Point(100, 50);
var gokuHpSize = new Size(400, 30);
var gokuHp = new Shape.Rectangle(gokuHpPoint, gokuHpSize);
gokuHp.strokeWidth = 0;
gokuHp.fillColor = 'green'

var gokuSubtractLife = 0
function gokuDecreaseLife(subtract){
	if (Math.abs(subtract) < 405){
		var rectangle = new Rectangle(new Point(500 + subtract, 50), new Point(500, 80));
		var path = new Path.Rectangle(rectangle);
		path.fillColor = 'white';
	}
}



//***********************VEGETA'S HP*******************************
var vegetaHpBorderPoint = new Point(1000, 50);
var vegetaHpBorderSize = new Size(400, 30);
var vegetaHpBorder = new Shape.Rectangle(vegetaHpBorderPoint, vegetaHpBorderSize);
vegetaHpBorder.strokeColor = 'red';
vegetaHpBorder.strokeWidth = 10;

var vegetaHpPoint = new Point(1000, 50);
var vegetaHpSize = new Size(400, 30);
var vegetaHp = new Shape.Rectangle(vegetaHpPoint, vegetaHpSize);
vegetaHp.strokeWidth = 0;
vegetaHp.fillColor = 'green'


var vegetaSubtractLife = 0
function vegetaDecreaseLife(subtract){
	if (Math.abs(subtract) < 405){
		var rectangle = new Rectangle(new Point(1000, 50), new Point(1000 + subtract, 80));
		var path = new Path.Rectangle(rectangle);
		path.fillColor = 'white';
	}
}

//*******************GOKU'S CHARACTER SET - UP**********************
var character = new Raster(gokuSteadyState[0])
character.position = new Point(100, 800);
character.scale(1.2, 1.2)

var gokuHitEffects = new Raster(gokuHitEffectsList[0]);
gokuHitEffects.position = new Point(character.position.x, character.position.y)
gokuHitEffects.scale(1)
gokuHitEffects.visible = false



//*******************VEGETA'S CHARACTER SET - UP**********************

var other_character = new Raster(vegetaSteadyState[0])
other_character.position = new Point(1400, 800);
other_character.scale(-1.2, 1.2)

var vegetaHitEffects = new Raster(vegetaHitEffectsList[0]);
vegetaHitEffects.position = new Point(other_character.position.x, other_character.position.y)
vegetaHitEffects.scale(1)
vegetaHitEffects.visible = false


//GOKU'S VARIABLES
var gokuLeftPosition = true;
var gokuRightPosition = false;

var gokuSteadyStateSequence = 0;

var gokuPunchConfirmation = false;
var gokuKickConfirmation = false;
var gokuKiBlastConfirmation = false;
var gokuSSConfirmation = false;

var gokuAttackSequenceCount = 0

var gokuPowerUpSequenceCount = 0
var gokuPowerUpLevel = 0

var gokuSScount = 5

var gokuHitCount = 0

var gokuHitsVegeta = false

var gokuKiBlastAppear = false

var kamehamehaSequence = 0;
var gokuSsChargingSequenceCount = 0;

var gokuHitEffectsSequence = 0

var gokuDeadStateSequenceCount = 0

var gokuDead = false



//VEGETA'S VARIABLES

var vegetaLeftPosition = false;
var vegetaRightPosition = true;

var vegetaSteadyStateSequenceCount = 0;
var vegetaPunchConfirmation = false;
var vegetaKickConfirmation = false;
var vegetaKiBlastConfirmation = false;
var vegetaSSConfirmation = false;

var vegetaAttackSequenceCount = 0

var vegetaSScount = 5

var vegetaHitCount = 0

var vegetaHitsGoku = false

var vegetaKiBlastAppear = false

var galickGunSequenceCount = 0;

var vegetaSsChargingSequenceCount = 0;

var vegetaHitEffectsSequence = 0

var vegetaDeadStateSequenceCount = 0

var vegetaDead = false


//*********************BATTLE TIMER*****************************
var countDownTimer = new PointText(new Point(750, 80))
countDownTimer.justification = 'center'
countDownTimer.content = 60
countDownTimer.fillColor = 'white'
countDownTimer.fontWeight = 'bold'
countDownTimer. fontSize = 60
countDownTimer.fontFamily = 'serif'
countDownTimer.shadowColor = new Color(0, 0, 0)
countDownTimer.shadowBlur = 12
countDownTimer.shadowOffset = new Point(5, 5)
countDownTimer.onFrame = countDown
function countDown (event){
	if (this.content <= 60 && this.content > 0){
		if (event.count % 60 == 0 && startGame){
			this.content -= 1
		}
	}
	else {
		this.content = 0
		if (this.content == 0) {
			gokuDead = true
			vegetaDead = true
			showWinner()
		}
	}
}

//*******************************WINNER SHOW**************************
function showWinner(){
	console.log(Math.abs(gokuSubtractLife))
	console.log(Math.abs(vegetaSubtractLife))
	if (gokuDead == true && vegetaDead == false){
		var winnerResult = new PointText(new Point(750, 500))
		winnerResult.justification = 'center'
		winnerResult.content = 'Player 2 Wins'
		winnerResult.fillColor = 'white'
		winnerResult.fontWeight = 'bold'
		winnerResult. fontSize = 100
		winnerResult.fontFamily = 'serif'
		winnerResult.shadowColor = new Color(0, 0, 0)
		winnerResult.shadowBlur = 12
		winnerResult.shadowOffset = new Point(5, 5)
	}
	else if (vegetaDead == true && gokuDead == false){
		var winnerResult = new PointText(new Point(750, 500))
		winnerResult.justification = 'center'
		winnerResult.content = 'Player 1 Wins'
		winnerResult.fillColor = 'white'
		winnerResult.fontWeight = 'bold'
		winnerResult. fontSize = 100
		winnerResult.fontFamily = 'serif'
		winnerResult.shadowColor = new Color(0, 0, 0)
		winnerResult.shadowBlur = 12
		winnerResult.shadowOffset = new Point(5, 5)
	}
	else if (gokuDead == vegetaDead) {
		if (Math.abs(gokuSubtractLife) == Math.abs(vegetaSubtractLife)) {
			var winnerResult = new PointText(new Point(750, 500))
			winnerResult.justification = 'center'
			winnerResult.content = 'Draw'
			winnerResult.fillColor = 'white'
			winnerResult.fontWeight = 'bold'
			winnerResult. fontSize = 100
			winnerResult.fontFamily = 'serif'
			winnerResult.shadowColor = new Color(0, 0, 0)
			winnerResult.shadowBlur = 12
			winnerResult.shadowOffset = new Point(5, 5)
		}
		else if (Math.abs(gokuSubtractLife) > Math.abs(vegetaSubtractLife)){
			var winnerResult = new PointText(new Point(750, 500))
			winnerResult.justification = 'center'
			winnerResult.content = 'Player 2 Wins'
			winnerResult.fillColor = 'white'
			winnerResult.fontWeight = 'bold'
			winnerResult. fontSize = 100
			winnerResult.fontFamily = 'serif'
			winnerResult.shadowColor = new Color(0, 0, 0)
			winnerResult.shadowBlur = 12
			winnerResult.shadowOffset = new Point(5, 5)
		}
		else if(Math.abs(gokuSubtractLife) < Math.abs(vegetaSubtractLife)){
			var winnerResult = new PointText(new Point(750, 500))
			winnerResult.justification = 'center'
			winnerResult.content = 'Player 1 Wins'
			winnerResult.fillColor = 'white'
			winnerResult.fontWeight = 'bold'
			winnerResult. fontSize = 100
			winnerResult.fontFamily = 'serif'
			winnerResult.shadowColor = new Color(0, 0, 0)
			winnerResult.shadowBlur = 12
			winnerResult.shadowOffset = new Point(5, 5)
		}
	}
	
}

//GOKU'S FUNCTIONS 

function setUpKamehameWave(){
	var kamehameHaHead = new Raster('js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_0-3.png')
	if (gokuLeftPosition){
		kamehameHaHead.position = new Point(character.position.x + 130, character.position.y - 30)
		kamehameHaHead.scale(3,3)
	}
	else if(gokuRightPosition){
		kamehameHaHead.position = new Point(character.position.x - 130, character.position.y - 30)
		kamehameHaHead.scale(-3,3)
	}
	
	kamehameHaHead.onFrame = gokuWaveMove
}

function gokuWaveMove(event){
	if (gokuLeftPosition){
		this.position.x += 50
	}
	else if(gokuRightPosition) {
		this.position.x -= 50
	}
	if (this.position.x >= 1400 || this.position.x <= 0) {
		this.remove()
	}
	else if (this.hitTest(other_character.bounds)){
		gokuHitsVegeta = true
		vegetaOnHit(event, gokuHitsVegeta)
		vegetaSubtractLife += 5
		vegetaDecreaseLife(vegetaSubtractLife)
	}
}


function gokuSetUpSSCharging(){
	var kamehaCharging = new Raster(gokuSSCharging[0])
	if (gokuLeftPosition){
		kamehaCharging.position = new Point(character.position.x - 33, character.position.y - 15)
		kamehaCharging.scale(1,1)
	}
	else if(gokuRightPosition){
		kamehaCharging.position = new Point(character.position.x + 33, character.position.y - 15)
		kamehaCharging.scale(-1,1)
	}
	kamehaCharging.onFrame = gokuSsChargingSequence
}

function gokuSsChargingSequence (event) {
	if(event.count % 2 == 0) {
		this.source = gokuSSCharging[gokuSsChargingSequenceCount]
		if (gokuSsChargingSequenceCount > 7){
			gokuSsChargingSequenceCount = 0
			this.remove()
		}
		gokuSsChargingSequenceCount++
	}
}



function gokuSetUpkiBlast(event) {
	if(gokuKiBlastAppear) {
		var gokuKi = new Raster('js/Ki Blast/ki_blast.png')

		if (gokuLeftPosition){
			gokuKi.position = new Point(character.position.x + 100, character.position.y - 30)
			gokuKi.scale(2, 2)
		}
		else if(gokuRightPosition){
			gokuKi.position = new Point(character.position.x - 100, character.position.y - 30)
			gokuKi.scale(-2, 2)
		}

		gokuKi.onFrame = gokuKiBlastMove

		return gokuKi.position
	}

}

function gokuKiBlastMove (event) {
	if (gokuLeftPosition){
		this.position.x += 30
	}
	else if (gokuRightPosition){
		this.position.x -= 30
	}
	else if (this.hitTest(vegetaSetUpkiBlast())) this.remove();

	if (this.position.x > 1400 || this.position.x <= 0) this.remove();
	
	if (Math.abs(other_character.position.x - this.position.x) <= 5){
		if (Math.abs(other_character.position.y - this.position.y) <= 80){
			gokuHitsVegeta = true
			this.remove()
			vegetaOnHit(event,gokuHitsVegeta)
			vegetaSubtractLife += 5
			vegetaDecreaseLife(vegetaSubtractLife)
		}
	}
}


function gokuAttackPunch(event) {
	if (event.count % 4 == 0) {
		gokuAttackSequenceCount++;
		if (gokuAttackSequenceCount > 13) {
			gokuAttackSequenceCount = 0;
			character.onFrame = actionGoku
		}
		this.source = gokuPunch[gokuAttackSequenceCount]
		gokuHitsVegeta = false;
		gokuHitResult1()
		vegetaOnHit(event, gokuHitsVegeta)
	}
}

function gokuAttackKick(event) {
	if (event.count % 4 == 0) {
		gokuAttackSequenceCount++;
		if (gokuAttackSequenceCount > 13) {
			gokuAttackSequenceCount = 0;
			character.onFrame = actionGoku
		}
		this.source = gokuKick[gokuAttackSequenceCount]
		gokuHitsVegeta = false;
		gokuHitResult2()
		vegetaOnHit(event, gokuHitsVegeta)
	}
}

function gokuAttackKiBlast(event) {
	if (event.count % 5 == 0) {
		gokuAttackSequenceCount++;
		if (gokuAttackSequenceCount > 4) {
			gokuAttackSequenceCount = 0;
			character.onFrame = actionGoku
		}
		this.source = gokuKiBlast[gokuAttackSequenceCount]
		if (gokuAttackSequenceCount == 4) {
			gokuHitsVegeta = false
			gokuSetUpkiBlast()
		}
	}
}

function gokuAttackSS(event) {
	if (event.count % 10 == 0) {
		gokuAttackSequenceCount++;
		if (gokuAttackSequenceCount > 7) {
			gokuAttackSequenceCount = 0;
			character.onFrame = actionGoku
		}
		else if (gokuAttackSequenceCount == 4) {
			gokuSetUpSSCharging()
		}
		else if (gokuAttackSequenceCount ==  7) {
			setUpKamehameWave()
		}
		this.source = gokuSS[gokuAttackSequenceCount]
	}
}

function gokuHitResult1(event){
	if (Math.abs(character.position.x - other_character.position.x) <= 130 && character.position.x < other_character.position.x) {
		if (Math.abs(character.position.y - other_character.position.y) <= 20 && character.position.y <= other_character.position.y){
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
		else if (Math.abs(character.position.y - other_character.position.y) <= 200 && character.position.y > other_character.position.y) {
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
	}

	else if (Math.abs(character.position.x - other_character.position.x) <= 130 && character.position.x > other_character.position.x) {
		if (Math.abs(character.position.y - other_character.position.y) <= 20 && character.position.y >= other_character.position.y){
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
		else if (Math.abs(character.position.y - other_character.position.y) <= 200 && character.position.y < other_character.position.y) {
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
	}
}


function gokuHitResult2(event) {
	if (Math.abs(character.position.x - other_character.position.x) <= 150 && character.position.x < other_character.position.x){
			if (Math.abs(character.position.y - other_character.position.y) <= 20 && character.position.y <= other_character.position.y){
				gokuHitsVegeta = true
				vegetaSubtractLife += 1
				vegetaDecreaseLife(vegetaSubtractLife)
			}
			else if (Math.abs(character.position.y - other_character.position.y) <= 75 && character.position.y > other_character.position.y) {
				gokuHitsVegeta = true
				vegetaSubtractLife += 1
				vegetaDecreaseLife(vegetaSubtractLife)
			}
	}
	else if (Math.abs(character.position.x - other_character.position.x) <= 150 && character.position.x > other_character.position.x){
		if (Math.abs(character.position.y - other_character.position.y) <= 20 && character.position.y >= other_character.position.y){
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
		else if (Math.abs(character.position.y - other_character.position.y) <= 75 && character.position.y < other_character.position.y) {
			gokuHitsVegeta = true
			vegetaSubtractLife += 1
			vegetaDecreaseLife(vegetaSubtractLife)
		}
	}

}



function actionGoku(event){
	if (Key.isDown('d') && !gokuDead && startGame){
		if (gokuLeftPosition) character.source = 'js/personas/Goku/Regular/Goku_0-41.png';
		else character.source = 'js/personas/Goku/Regular/Goku_0-38.png';
		if (character.position.x < 1400) {
			character.position.x += 10;
			if (character.hitTest(other_character.position) && gokuLeftPosition) {
				other_character.position.x += 15;
			}
		}
	}
	else if (Key.isDown('a') && !gokuDead && startGame){
		if (gokuLeftPosition) character.source = 'js/personas/Goku/Regular/Goku_0-38.png';
		else character.source = 'js/personas/Goku/Regular/Goku_0-41.png';
		if (character.position.x > 100) {
			character.position.x -= 10
			if(character.hitTest(other_character.position) && gokuRightPosition){
				other_character.position.x -= 15;
			}

		}
	}
	else if (Key.isDown('w') && !gokuDead && startGame){
		character.source = 'js/personas/Goku/Regular/Goku_0-24.png'
		if (character.position.y > 100) character.position.y -= 10;	
	}
	else if (Key.isDown('s') && !gokuDead && startGame){
		if (character.position.y < 800){
			character.position.y += 10
			character.source = 'js/personas/Goku/Regular/Goku_0-29.png'
		}		
	}
	else if(Key.isDown('h') && !gokuDead && startGame){
		if(gokuPowerUpSequenceCount < 5){
			gokuPowerUpSequenceCount++
		}
	}
	else if (gokuPunchConfirmation && !gokuDead) {
		character.onFrame = gokuAttackPunch
	}
	else if (gokuKickConfirmation) {
		character.onFrame = gokuAttackKick
	}
	else if (gokuKiBlastConfirmation) {
		character.onFrame = gokuAttackKiBlast
		gokuKiBlastAppear = true
	}
	else if (gokuSSConfirmation) {
		character.onFrame = gokuAttackSS
		gokuSScount -= 1;
		
	}
	else if (event.count % 10 == 0) {
		if (Math.abs(gokuSubtractLife) < 400){
			gokuSteadyStateSequence++;
			if (gokuSteadyStateSequence > 5) {
				gokuSteadyStateSequence = 0;
			}
		character.source = gokuSteadyState[gokuSteadyStateSequence]
		}
		else if(Math.abs(gokuSubtractLife) >= 400){
			gokuDead = true
			if(event.count % 10 == 0){
				gokuDeadStateSequenceCount++
				if (gokuDeadStateSequenceCount > 4){
					character.source = gokuDeadStateSequence[4]
					if (character.position.y < 800){
						character.position.y += 100
						character.source = 'js/personas/Goku/Regular/Goku_0-257.png'
					}
					showWinner()
				}
				else {
					character.source = gokuDeadStateSequence[gokuDeadStateSequenceCount]
				}
			}
		}
	}
}

function gokuOnHit(event, hit) {
	if (hit) {
		gokuHitEffects.visible = true
		vegetaHitCount++
		gokuHitEffects.visible = true
		if (vegetaHitCount > 10) {
			vegetaHitCount = 0;
		}
			
		if (event.count % 2 == 0) {
			character.source = gokuBeingHit[vegetaHitCount]
		}
		gokuHitEffectsSequence++
		if (gokuHitEffectsSequence > 1) {
			gokuHitEffectsSequence = 0;
			
		}
		gokuHitEffects.source = gokuHitEffectsList[gokuHitEffectsSequence]
		gokuHitEffects.position = new Point(character.position.x, character.position.y)
		gokuHitEffects.scale(1)
	}
	gokuHitEffects.visible = false
}



character.onFrame =  actionGoku

//VEGETA'S FUNCTIONS

function setUpGalickGun(){
	var galickGunHead = new Raster('js/Ki Blast/Kamehameha/Kamehameha Sprites/Kamehameha_0-3.png')
	if (vegetaLeftPosition){
		galickGunHead.position = new Point(other_character.position.x + 130, other_character.position.y - 30)
		galickGunHead.scale(3,3)
	}
	else if(vegetaRightPosition){
		galickGunHead.position = new Point(other_character.position.x - 130, other_character.position.y - 30)
		galickGunHead.scale(-3,3)
	}
	
	galickGunHead.onFrame = vegetaWaveMove
}

function vegetaWaveMove(event){
	if (vegetaLeftPosition){
		this.position.x += 50
	}
	else if(vegetaRightPosition) {
		this.position.x -= 50
	}
	if (this.position.x > 1400 || this.position.x <= 0) {
		this.remove()
	}
	else if (this.hitTest(character.bounds)){
		vegetaHitsGoku = true
		gokuOnHit(event, vegetaHitsGoku)
		gokuSubtractLife -= 5
		gokuDecreaseLife(gokuSubtractLife)
	}
}


function vegetaSetUpSSCharging(){
	var galickGunCharging = new Raster(vegetaSSCharging[0])
	if (vegetaLeftPosition){
		galickGunCharging.position = new Point(other_character.position.x - 13, other_character.position.y - 48)
		galickGunCharging.scale(1,1)
	}
	else if(vegetaRightPosition){
		galickGunCharging.position = new Point(other_character.position.x + 13, other_character.position.y - 48)
		galickGunCharging.scale(-1,1)
	}
	galickGunCharging.onFrame = vegetaSsChargingSequence
}

function vegetaSsChargingSequence (event) {
	if(event.count % 2 == 0) {
		this.source = vegetaSSCharging[vegetaSsChargingSequenceCount]
		if (vegetaSsChargingSequenceCount > 7){
			vegetaSsChargingSequenceCount = 0
			this.remove()
		}
		vegetaSsChargingSequenceCount++
	}
}


function vegetaSetUpkiBlast(event) {
	if(vegetaKiBlastAppear) {
		var vegetaKi = new Raster('js/Ki Blast/ki_blast.png')

		if (vegetaLeftPosition){
			vegetaKi.position = new Point(other_character.position.x + 100, other_character.position.y - 30)
			vegetaKi.scale(2, 2)
		}
		else if(vegetaRightPosition){
			vegetaKi.position = new Point(other_character.position.x - 100, other_character.position.y - 30)
			vegetaKi.scale(-2, 2)
		}

		vegetaKi.onFrame = vegetaKiBlastMove

		return vegetaKi.position
	}

}

function vegetaKiBlastMove (event) {
	var leftMoveKiBlastLatch = false
	var rightKiBlastLatch = false

	if (vegetaLeftPosition && this){
		this.position.x += 30
	}
	else if (vegetaRightPosition && this){
		this.position.x -= 30
	}
	else if (this.hitTest(gokuSetUpkiBlast())) this.remove();

	if (this.position.x > 1400 || this.position.x <= 0) this.remove();
	
	if (Math.abs(character.position.x - this.position.x) <= 5){
		if (Math.abs(character.position.y - this.position.y) <= 80){
			vegetaHitsGoku = true
			this.remove()
			gokuOnHit(event,vegetaHitsGoku)
			gokuSubtractLife -= 5
			gokuDecreaseLife(gokuSubtractLife)
		}
	}
}


function vegetaAttackPunch(event) {
	if (event.count % 4 == 0) {
		vegetaAttackSequenceCount++;
		if (vegetaAttackSequenceCount > 13) {
			vegetaAttackSequenceCount = 0;
			other_character.onFrame = actionVegeta
		}
		this.source = vegetaPunch[vegetaAttackSequenceCount]
		vegetaHitsGoku = false;
		vegetaHitResult1()
		gokuOnHit(event, vegetaHitsGoku)
	}
}

function vegetaAttackKick(event) {
	if (event.count % 4 == 0) {
		vegetaAttackSequenceCount++;
		if (vegetaAttackSequenceCount > 13) {
			vegetaAttackSequenceCount = 0;
			other_character.onFrame = actionVegeta
		}
		this.source = vegetaKick[vegetaAttackSequenceCount]
		vegetaHitsGoku = false;
		vegetaHitResult2()
		gokuOnHit(event, vegetaHitsGoku)
	}
}

function vegetaAttackKiBlast(event) {
	if (event.count % 5 == 0) {
		vegetaAttackSequenceCount++;
		if (vegetaAttackSequenceCount > 4) {
			vegetaAttackSequenceCount = 0;
			other_character.onFrame = actionVegeta
		}
		this.source = vegetaKiBlast[vegetaAttackSequenceCount]
		if (vegetaAttackSequenceCount == 4) {
			vegetaHitsGoku = false
			vegetaSetUpkiBlast()
		}
	}
}

function vegetaAttackSS(event) {
	if (event.count % 10 == 0) {
		vegetaAttackSequenceCount++;
		if (vegetaAttackSequenceCount > 6) {
			vegetaAttackSequenceCount = 0;
			other_character.onFrame = actionVegeta
		}
		else if (vegetaAttackSequenceCount == 3) {
			vegetaSetUpSSCharging()
		}
		else if (vegetaAttackSequenceCount ==  6) {
			setUpGalickGun()
		}
		this.source = vegetaSS[vegetaAttackSequenceCount]
	}
}

function vegetaOnHit(event, gokuHitsVegeta) {
	if (gokuHitsVegeta) {
		gokuHitCount++
		vegetaHitEffects.visible = true
		if (gokuHitCount > 10) {
			gokuHitCount = 0;
		}
			
		if (event.count % 2 == 0) {
			other_character.source = vegetaHit[gokuHitCount]
		}
		vegetaHitEffectsSequence++
		if (vegetaHitEffectsSequence > 1) {
			vegetaHitEffectsSequence = 0;
		}

		vegetaHitEffects.source = gokuHitEffectsList[vegetaHitEffectsSequence]
		vegetaHitEffects.position = new Point(other_character.position.x, other_character.position.y)
		vegetaHitEffects.scale(1)
	}
	vegetaHitEffects.visible = false
}

function vegetaHitResult1(event){
	if (Math.abs(other_character.position.x - character.position.x) <= 130 && other_character.position.x > character.position.x) {
		if (Math.abs(other_character.position.y - character.position.y) <= 20 && other_character.position.y >= character.position.y){
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
		else if (Math.abs(other_character.position.y - character.position.y) <= 200 && other_character.position.y < character.position.y) {
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
	}
	else if (Math.abs(other_character.position.x - character.position.x) <= 130 && other_character.position.x < character.position.x) {
		if (Math.abs(other_character.position.y - character.position.y) <= 20 && other_character.position.y <= character.position.y){
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
		else if (Math.abs(other_character.position.y - character.position.y) <= 200 && other_character.position.y > character.position.y) {
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
	}
}


function vegetaHitResult2(event) {
	if (Math.abs(other_character.position.x - character.position.x) <= 150 && other_character.position.x > character.position.x){
		if (Math.abs(other_character.position.y - character.position.y) <= 20 && other_character.position.y >= character.position.y){
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
		else if (Math.abs(other_character.position.y - character.position.y) <= 75 && other_character.position.y < character.position.y) {
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
	}
	else if (Math.abs(other_character.position.x - character.position.x) <= 150 && other_character.position.x < character.position.x){
		if (Math.abs(other_character.position.y - character.position.y) <= 20 && other_character.position.y <= character.position.y){
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
		else if (Math.abs(other_character.position.y - character.position.y) <= 75 && other_character.position.y > character.position.y) {
			vegetaHitsGoku = true
			gokuSubtractLife -= 1
			gokuDecreaseLife(gokuSubtractLife)
		}
	}

}



function actionVegeta(event){
	if (Key.isDown('right') && !vegetaDead && startGame){
		if (vegetaLeftPosition) other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-34.png';
		else other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-36.png';

		if (other_character.position.x < 1400) {
			other_character.position.x += 10;
			if (other_character.hitTest(character.position) && vegetaLeftPosition) {
				character.position.x += 15;
			}
		}
	}
	else if (Key.isDown('left') && !vegetaDead && startGame){
		if (vegetaLeftPosition) other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-36.png';
		else other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-34.png';
		if (other_character.position.x > 100) {
			other_character.position.x -= 10;
			if (other_character.hitTest(character.position) && vegetaRightPosition) {
				character.position.x -= 15;
			}
		}
	}
	else if (Key.isDown('up') && startGame){
		other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-24.png'
		if (other_character.position.y > 100) other_character.position.y -= 10;	
	}
	else if (Key.isDown('down') && !vegetaDead && startGame){
		if (other_character.position.y < 800){
			other_character.position.y += 10
			other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-29.png'
		}		
	}
	else if (vegetaPunchConfirmation  && !vegetaDead) {
		other_character.onFrame = vegetaAttackPunch
	}
	else if (vegetaKickConfirmation  && !vegetaDead) {
		other_character.onFrame = vegetaAttackKick
	}
	else if (vegetaKiBlastConfirmation  && !vegetaDead) {
		other_character.onFrame = vegetaAttackKiBlast
		vegetaKiBlastAppear = true
	}
	else if (vegetaSSConfirmation  && !vegetaDead) {
		other_character.onFrame = vegetaAttackSS
		vegetaSScount -= 1
	}
	else if (event.count % 10 == 0) {
		if (Math.abs(vegetaSubtractLife) < 400){
			vegetaSteadyStateSequenceCount++;
			if (vegetaSteadyStateSequenceCount > 5) {
				vegetaSteadyStateSequenceCount = 0;
			}
		other_character.source = vegetaSteadyState[vegetaSteadyStateSequenceCount]
		}
		else if(Math.abs(vegetaSubtractLife) >= 400){
			vegetaDead = true
			if(event.count % 10 == 0){
				vegetaDeadStateSequenceCount++
				if (vegetaDeadStateSequenceCount > 4){
					other_character.source = vegetaDeadStateSequence[4];
					if (other_character.position.y < 800){
						other_character.position.y += 100
						other_character.source = 'js/personas/Vegeta/Regular/Vegeta_0-246.png'
					}
					showWinner()
				}
				else {
					other_character.source = vegetaDeadStateSequence[gokuDeadStateSequenceCount]
				}
			}
		}
	}
}


other_character.onFrame = actionVegeta

//KEY DOWN EVENTS

function onKeyDown(event) {
	//GOKU MOVES
	if (event.key == 'j' && !gokuDead && startGame) {
		console.log(gokuDead)
		gokuPunchConfirmation = true;
		gokuHitResult1()
	}
	else if  (event.key == 'k' && !gokuDead && startGame) {
		console.log(gokuDead)
		gokuKickConfirmation = true;
		gokuHitResult2()
	}
	else if (event.key == 'u' && !gokuDead && startGame) {
		gokuKiBlastConfirmation = true;
	}
	else if (event.key == 'i' && !gokuDead && startGame) {
		if (gokuSScount > 0){
			gokuSSConfirmation = true;
		}
	}

	//VEGETA MOVES
	if (event.key == '2' && !vegetaDead && startGame) {
		vegetaPunchConfirmation = true;
		vegetaHitResult1()
	}
	else if (event.key == '3' && !vegetaDead && startGame){
		vegetaKickConfirmation = true;
		vegetaHitResult2()
	}
	else if (event.key == '5' && !vegetaDead && startGame) {
		vegetaKiBlastConfirmation = true;
	}
	else if (event.key == '6' && !vegetaDead && startGame){
		if (vegetaSScount > 0){
			vegetaSSConfirmation =  true
		}
	}
	if(event.key == 'space'){
		bgMusic.play()
		startGame = true
		start.remove()
	}
}


//KEY UP EVENTS

function onKeyUp(event){
	//GOKU MOVES
	if (event.key == 'j') {
		gokuPunchConfirmation = false;
		
	}
	else if (event.key == 'k') {
		gokuKickConfirmation = false;

	}
	else if (event.key == 'u') {
		gokuKiBlastConfirmation = false;
	}
	else if (event.key == 'i') gokuSSConfirmation = false;

	if (event.key == 'd') {
		if (character.position.x > other_character.position.x){
			if (gokuLeftPosition) character.scale(-1, 1);
			gokuLeftPosition = false
			gokuRightPosition = true
		}
	}

	if (event.key == 'a') {
		if (character.position.x < other_character.position.x){
			if (gokuRightPosition) character.scale(-1, 1);
			gokuRightPosition = false
			gokuLeftPosition = true
		}
	}


	//VEGETA MOVES

	if (event.key == '2'){
		vegetaPunchConfirmation = false;
	}
	else if (event.key == '3') {
		vegetaKickConfirmation = false;
	}
	else if (event.key == '5'){
		vegetaKiBlastConfirmation = false;
	}
	else if (event.key == '6'){
		vegetaSSConfirmation = false
	}

	if (event.key == 'right'){
		if(other_character.position.x > character.position.x){
			if (vegetaLeftPosition) other_character.scale(-1, 1);
			vegetaLeftPosition = false
			vegetaRightPosition = true
		}
	}

	if (event.key == 'left'){
		if (other_character.position.x < character.position.x){
			if (vegetaRightPosition) other_character.scale(-1, 1);
			vegetaRightPosition = false
			vegetaLeftPosition = true
		}
	}


}